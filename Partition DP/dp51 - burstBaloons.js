/**
 * Too hard to understand at the moment.
 */